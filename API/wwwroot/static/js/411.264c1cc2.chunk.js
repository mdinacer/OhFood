"use strict";(self.webpackChunkoh_food=self.webpackChunkoh_food||[]).push([[411],{20411:function(e,n,r){r.r(n),r.d(n,{default:function(){return J}});var t=r(45987),s=r(15861),i=r(1413),a=r(29439),d=r(87757),c=r.n(d),l=r(68870),o=r(10266),u=r(4841),x=r(4567),m=r(99947),h=r(85982),Z=r(36053),p=r(5849),f=r(72791),j=r(61134),v=r(81153),y=r(93006),b=r(80184);function g(e){var n,r=(0,j.bc)((0,i.Z)((0,i.Z)({},e),{},{defaultValue:""})),t=r.fieldState,s=r.field;return(0,b.jsx)(y.Z,(0,i.Z)((0,i.Z)((0,i.Z)({},e),s),{},{multiline:e.multiline,rows:e.rows,type:e.type,fullWidth:!0,variant:"outlined",error:!!t.error,helperText:null===(n=t.error)||void 0===n?void 0:n.message}))}var k=r(25801),w=r(13034);function P(e){var n=(0,j.bc)((0,i.Z)((0,i.Z)({},e),{},{defaultValue:!1})).field;return(0,b.jsx)(k.Z,{control:(0,b.jsx)(w.Z,(0,i.Z)((0,i.Z)({},n),{},{checked:n.value,color:"secondary",disabled:e.disabled})),label:e.label})}function q(){var e=(0,j.Gc)(),n=e.control,r=e.formState;return(0,b.jsxs)(l.Z,{maxWidth:800,sx:{mx:"auto"},children:[(0,b.jsx)(x.Z,{variant:"h6",sx:{mb:3},children:"Shipping address"}),(0,b.jsxs)(v.ZP,{container:!0,spacing:3,children:[(0,b.jsx)(v.ZP,{item:!0,xs:12,sm:12,children:(0,b.jsx)(g,{control:n,name:"fullName",label:"Full name"})}),(0,b.jsx)(v.ZP,{item:!0,xs:12,md:8,children:(0,b.jsx)(g,{control:n,name:"address1",label:"Address"})}),(0,b.jsx)(v.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,b.jsx)(g,{control:n,name:"city",label:"City"})}),(0,b.jsx)(v.ZP,{item:!0,xs:12,children:(0,b.jsx)(P,{disabled:!r.isDirty,name:"saveAddress",label:"Save this as the default address",control:n})})]})]})}var A=r(43236),I=r(52411),S=r(49900),C=r(90977),R=r(36474),V=r(14645),W=r(32068),_=r(59496);function F(){var e=(0,R.CG)((function(e){return e.basket})),n=e.basket,r=e.status,t=(0,R.TL)();return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(x.Z,{variant:"h6",gutterBottom:!0,children:"Order summary"}),n&&(0,b.jsx)(A.Z,{sx:{overflow:"auto",flex:"1 1 auto",px:1},children:n.items.length>0&&n.items.map((function(e){return(0,b.jsx)(I.ZP,{sx:{py:0},children:(0,b.jsx)(S.Z,{children:(0,b.jsx)(l.Z,{component:u.Z,sx:{px:1,py:1},children:(0,b.jsxs)(v.ZP,{container:!0,alignItems:"center",children:[(0,b.jsx)(v.ZP,{item:!0,md:3,xs:1,sx:{px:1,display:{xs:"block",md:"none"}},children:(0,b.jsx)(V.Z,{quantity:e.quantity,increase:function(){return t((0,W.JW)({productId:e.productId}))},decrease:function(){return t((0,W.di)({productId:e.productId,quantity:1,name:"rem"}))},isRow:!1,minValue:1,loading:r.includes("pending")})}),(0,b.jsx)(v.ZP,{item:!0,md:6,xs:11,children:(0,b.jsx)(o.Z,{children:(0,b.jsxs)(l.Z,{display:"flex",flexDirection:"column",children:[(0,b.jsx)(x.Z,{variant:"caption",color:"text.secondary",children:e.type}),(0,b.jsx)(x.Z,{variant:"subtitle1",children:e.name})]})})}),(0,b.jsx)(v.ZP,{item:!0,md:3,xs:0,sx:{px:1,display:{xs:"none",md:"block"}},children:(0,b.jsx)(V.Z,{quantity:e.quantity,increase:function(){return t((0,W.JW)({productId:e.productId}))},decrease:function(){return t((0,W.di)({productId:e.productId,quantity:1,name:"rem"}))},isRow:!0,minValue:1,loading:r.includes("pending")})}),(0,b.jsx)(v.ZP,{item:!0,md:2,xs:10,children:(0,b.jsxs)(x.Z,{textAlign:"center",variant:"body1",children:[e.price*e.quantity," DA"]})}),(0,b.jsx)(v.ZP,{item:!0,md:1,xs:2,children:(0,b.jsx)(C.Z,{sx:{mx:"auto",width:"100%"},onClick:function(){return t((0,W.di)({productId:e.productId,quantity:e.quantity,name:"del"}))},children:(0,b.jsx)(_.Z,{})})})]})})})},e.name)}))}),(0,b.jsxs)(v.ZP,{container:!0,children:[(0,b.jsx)(v.ZP,{item:!0,xs:6}),(0,b.jsx)(v.ZP,{item:!0,xs:6})]})]})}var N=r(61265),T=r(32292),D=T.Ry({fullName:T.Z_().required("Please enter your name"),address1:T.Z_().required("Please enter your address"),city:T.Z_().required()}),G=r(30260),O=r(94446),B=["saveAddress"],E=["Address","Review","Receipt"];function J(){var e=(0,f.useState)(0),n=(0,a.Z)(e,2),r=n[0],d=n[1],v=(0,f.useState)(0),y=(0,a.Z)(v,2),g=y[0],k=y[1],w=(0,f.useState)(!1),P=(0,a.Z)(w,2),A=P[0],I=P[1],S=(0,R.TL)();(0,R.CG)((function(e){return e.basket})).basket;var C=(0,j.cI)({mode:"all",resolver:(0,N.X)(D)});function V(e){return _.apply(this,arguments)}function _(){return(_=(0,s.Z)(c().mark((function e(n){var r,s,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return I(!0),r=n.saveAddress,s=(0,t.Z)(n,B),e.prev=2,e.next=5,G.Z.Orders.create({saveAddress:r,shippingAddress:s});case 5:i=e.sent,k(i),S((0,W.RT)()),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:return e.prev=13,I(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[2,10,13,16]])})))).apply(this,arguments)}(0,f.useEffect)((function(){G.Z.Account.fetchAddress().then((function(e){e&&C.reset((0,i.Z)((0,i.Z)((0,i.Z)({},C.getValues()),e),{},{saveAddress:!1}))}))}),[C]);var T=function(){var e=(0,s.Z)(c().mark((function e(n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==r){e.next=5;break}return e.next=3,V(n);case 3:e.next=6;break;case 5:d(r+1);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,b.jsx)(l.Z,{className:"payment",children:(0,b.jsx)(o.Z,{sx:{pt:7},children:(0,b.jsx)(j.RV,(0,i.Z)((0,i.Z)({},C),{},{children:(0,b.jsxs)(u.Z,{variant:"outlined",sx:{maxWidth:800,my:{xs:3,md:6},mx:"auto",p:{xs:2,md:3},backgroundColor:"rgba(0,0,0,0.5)"},children:[(0,b.jsx)(x.Z,{component:"h1",variant:"h4",align:"center",children:"Order"}),(0,b.jsx)(m.Z,{activeStep:r,sx:{pt:3,pb:5},children:E.map((function(e){return(0,b.jsx)(h.Z,{children:(0,b.jsx)(Z.Z,{children:e})},e)}))}),(0,b.jsx)(b.Fragment,{children:r===E.length?(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(x.Z,{variant:"subtitle1",children:["Your order number is #",g,". We have emailed your order confirmation, and will not send you an update when your order has shipped!"]})}):(0,b.jsxs)("form",{onSubmit:C.handleSubmit(T),children:[function(e){switch(e){case 0:return(0,b.jsx)(q,{});case 1:return(0,b.jsx)(F,{});default:throw new Error("Unknown step")}}(r),(0,b.jsxs)(l.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[0!==r&&(0,b.jsx)(p.Z,{onClick:function(){d(r-1)},sx:{mt:3,ml:1},children:"Back"}),(0,b.jsx)(O.Z,{loading:A,disabled:!C.formState.isValid,variant:"contained",type:"submit",sx:{mt:3,ml:1},children:r===E.length-1?"Place order":"Next"})]})]})})]})}))})})}}}]);
//# sourceMappingURL=411.264c1cc2.chunk.js.map